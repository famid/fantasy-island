import{a as s,j as e,r as o,R as v,c as N,F as w}from"./clsx.m-340daf83.js";import{k as T}from"./ReactToastify-2767fbe6.js";import{n as p}from"./notify-4fa6a864.js";import{u as C,M as S}from"./Modal-a0754083.js";import{T as _}from"./Table-ca06eba1.js";import{d as O}from"./uitls-6342bc87.js";import"./FocusTrap-e9c018ce.js";import"./Box-b9249870.js";import"./use-window-event-0ced1140.js";function j({ticket:a,csrfToken:n}){const l=async()=>{try{(await fetch(`admin/tickets/${a.id}/use`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({})})).ok&&(p(`${a.id} number ticket has been marked as used successfully`),setTimeout(()=>{location.reload()},1300))}catch(c){console.log(c)}};return s("div",{className:"flex gap-1 mb-1 p-1 bg-slate-200",children:[a.ticket_used_status==1&&e("span",{className:"bg-red-100",children:"Used"}),e("span",{children:a.unique_code}),a.ticket_used_status==0&&e("button",{onClick:l,className:"bg-blue-400 hover:bg-blue-500 text-[10px] text-white p-1",children:"Mark Used"})]})}function E({orders:a,csrfToken:n}){const[l,{open:c,close:d}]=C(!1),[i,h]=o.useState(null),[m,f]=o.useState(!0),b=t=>{c(),h(t)},g=async t=>{if(t)try{(await fetch(`admin/orders/${t.id}/tickets/use`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n},body:JSON.stringify({})})).ok&&(p(`${t.id} order tickets have been marked as used successfully`),setTimeout(()=>{location.reload()},1300))}catch(r){console.log(r)}},x=t=>{let r=!0;return t.tickets.forEach(u=>{u.ticket_used_status==0&&(r=!1)}),r},y=t=>new Date(t).toISOString().substr(0,10),k=a.map(t=>s("tr",{className:"dashboard-table",children:[e("td",{children:t.name}),e("td",{children:t.payment_status==1?e("span",{className:"bg-green-400 p-1",children:"Paid"}):e("span",{className:"bg-red-400 p-1",children:"Unpaid"})}),e("td",{children:t.merchant_account_phone}),e("td",{children:t.client_phone}),e("td",{children:y(t.purchase_date)}),e("td",{children:t.transaction_id}),s("td",{className:"gap-2 flex-col justify-center flex items-center",children:[e("span",{children:t.tickets.length}),t.tickets.length>1&&!x(t)&&s("button",{onClick:()=>b(t),className:"p-1 bg-blue-400 hover:bg-blue-600 text-white rounded-xl text-[10px]",children:["Mark All ",e("br",{})," ticket as used"," "]})]}),e("td",{children:t.tickets.map((r,u)=>e(j,{csrfToken:n,ticket:r}))})]},t.unique_code));return s("div",{className:"flex h-screen bg-white",children:[m&&s("div",{className:"flex flex-col w-48 bg-white border-r",children:[e("div",{className:"flex flex-col items-center h-16 bg-gray-200 justify-center",children:e("span",{className:"text-2xl font-bold",children:"Dashboard"})}),e("div",{className:"flex flex-col pt-4",children:e("a",{href:"#",className:"px-4 py-2 text-gray-600 hover:bg-gray-100 hover:text-gray-800",children:"Order List"})})]}),s("div",{className:"flex flex-col flex-1 overflow-y-auto",children:[s("div",{className:"flex items-center justify-between px-6 py-4 bg-white border-b",children:[e("span",{className:"text-lg font-bold",children:"Order List"}),e("button",{onClick:()=>f(!m),className:"p-2 bg-gray-200 rounded-full hover:bg-gray-300",children:e("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6 fill-current",children:e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 4a2 2 0 012-2h12a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 2v10h12V6H6zm12 1.5a.5.5 0 00-.5-.5h-11a.5.5 0 000 1h11a.5.5 0 00.5-.5zm0 4a.5.5 0 00-.5-.5h-11a.5.5 0 000 1h11a.5.5 0 00.5-.5zm0 4a.5.5 0 00-.5-.5h-11a.5.5 0 000 1h11a.5.5 0 00.5-.5z"})})})]}),s("div",{className:"px-6 py-4",children:[s(_,{withColumnBorders:!0,highlightOnHover:!0,children:[e("thead",{children:s("tr",{children:[e("th",{children:"Name"}),e("th",{children:"Payment Status"}),e("th",{children:"Merchant Phone"}),e("th",{children:"Client Phone"}),e("th",{children:"Purchase Date"}),e("th",{children:"Transaction Id"}),e("th",{children:"Tickets Counts"}),e("th",{children:"Tickets"})]})}),e("tbody",{children:k})]})," "]})]}),e(S,{opened:l,onClose:d,children:s("div",{children:[s("h2",{className:"text-2xl ",children:[" ","Are you sure to update all the tickets as used!"]}),s("div",{className:"flex gap-4 mt-4",children:[e("button",{onClick:()=>d(),className:"bg-red-300 p-2 text-white hover:bg-red-600 rounded-sm",children:"Cancel"}),e("button",{onClick:()=>g(i),className:"bg-blue-300 p-2 text-white hover:bg-blue-600 rounded-sm",children:"Confirm"})]})]})})]})}window.React=v;function M({csrf:a,authUser:n}){const[l,c]=o.useState([]);return o.useEffect(()=>{n||(window.location.href=`${O}/login`)},[n]),o.useEffect(()=>{console.log(n),(async()=>{try{const i=await fetch("admin/orders/list");if(i.ok){const h=await i.json();c([...h.data.data])}}catch(i){console.log(i)}})()},[]),s(w,{children:[e(T,{}),e(E,{csrfToken:a,orders:l})]})}if(document.getElementById("dashboard")){const a=document.getElementById("dashboard"),n=N(a);let l=a.dataset.csrf_token,c=a.dataset.authuser;n.render(e(M,{csrf:l,authUser:c}))}
